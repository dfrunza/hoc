include "abs.hoc";
include "minmax.hoc";

proc float sqrt_iter(float x, float g)
{
  var float r = x/g;

  if(r != g)
  {
    r = (r+g)/2.0;
    if(fabs(r-g) == 1.0)
      r = fmin(r, g);
  }
  return r;
}

/*
   Computes the largest number 'r' such that 'r*r <= x'
 */
proc float sqrt(float x)
{
  var float g = x;
  var float r = 1.0;

  while((g > 0.0) && (g != r))
  {
    g = r;
    r = sqrt_iter(x, g);
  }
  return g;
}
